---
title: GWU TwitterSets & the tweet Hydrator
author: ''
date: '2020-07-15'
slug: gwu-twittersets-the-tweet-hydrator
categories: []
tags: []
---



```{r include=FALSE}
tweet_dir <-  '/home/jtimm/jt_work/GitHub/twitter_corpus/tweets/gwu/'
```



## Quick thoughts historical Twitter corpus

Some notes and reminders re:Twitter.  I use the R package `rtweet` for accessing tweets. It is fantastic.  I generally do not get greedy when it comes to Twitter data; I work with well-defined universes/research questions and focus on methods.  That said, I recently became interested in building a Twitter corpus of all US lawmaker tweets from congresses 115 & 116.   So, 3 January 2017 to present day.   

Per my limited understanding, if I wanted to build this corpus today, I would run into (at least) two problems: (1) I would be limited to querying only the last 3,200 statuses posted or retweeted per lawmaker,  and (2) I would not have access to accounts/tweets that have been deleted.  And folks that leave office often abandon (ie, delete) official congressional accounts.  

The only real way to build an historical Twitter corpus, then, is to build one in real time, ie, scrape tweets for some universe of tweeters weekly or monthly, etc.  For me, that ship has sailed.  But other/smarter folks have been doing this -- eg -- the [George Washington University (GWU) Library](https://tweetsets.library.gwu.edu/).  

However, Twitter does not allow GWU to share the actual tweet data -- only the tweet ids.  So, I can download the list of ids for the 2M or so tweets generated by the members of the 115th US Congress, and then obtain the actual tweet data via a tweet hydrator.  DocNow's [Hydrator](https://github.com/DocNow/hydrator) is very slick.  This allows me to go a bit further back in time than `rtweet` (not clear how/why); and while I still cannot obtain tweets from accounts that have been deleted, I can build a fairly functional historical corpus of tweets composed by members of US Congresses 115 & 116.  And moving forward, I can update it on my own.  

A note on coverage: Of the ~1.6M (original content) tweet ids included in GWU's US Congress 116 tweet cache,  only ~1% have been deleted (as of 7.14.2020).  Also note: in some cases, tweets included in GWU list for a given congress were not generated while that congress was in session.



## Load tweets as corpus

RTs excluded.  Tweets limited to duration of congress.  Accessed mid-July 2020.

```{r message=FALSE, warning=FALSE}
library(tidyverse)
setwd(tweet_dir)

gfiles <- list.files(path = tweet_dir, 
                     pattern = "rds", 
                     recursive = TRUE) 

corpus_raw <- lapply(gfiles, readRDS) 
corpus_tif <- data.table::rbindlist(corpus_raw) 
```


## Corpus descriptives

Some important trends. Some (potential) explanations:
 
(1) Average length of tweets (in words) increased substantially from 2017 to 2018; presumably a result of Twitter's increased character limit from 140 to 280 at the end of 2017. 


(2) Total number of Twitter lawmaker accounts roughly doubled from the 115th congress to the 116th. Without any real effects on the number of total tweets from 115 to 116.  The folks at GWU included "auxiliary" accounts for members in the 116th Twitter scrape, eg, both "office" & "campaign" accounts.  

It is not clear if this is per some methodological change on the part of GWU, or a result of more lawmakers in 116 using more than one account.  


```{r message=FALSE, warning=FALSE}
xsum1 <- corpus_tif %>%
  mutate(tokens = tokenizers::count_words(text),
         yr = gsub('-.*', '', created_at))

xsum2 <- xsum1 %>%
  group_by(congress, yr) %>%
  summarise(tweets = n(),
            tokens = sum(tokens),
            ers = length(unique(toupper(user_screen_name))),
            ave = round(tokens/tweets, 1)) %>%
  mutate(tweets = formatC(tweets, big.mark = ','),
         tokens = formatC(tokens, big.mark = ','))

xsum2 %>% knitr::kable()
```


## Daily tweets 

3 Jan 2017 - 5 May 2020; With rolling bi-monthly averages in blue.  Still need to include tweets from the last several months.  So, despite disparities in the number of Twitter accounts associated with each congress, a fairly smooth transition from congress 115 to 116 in terms of daily tweet count; but a transition nonetheless -- which seems reasonable.  And some fairly intuitive congressional/yearly patterns in variation.

```{r fig.height=6, message=FALSE, warning=FALSE}
xsum1 %>%
  group_by(congress, yr, created_at) %>%
  summarise(tweets = n(),
            tokens = sum(tokens),
            ers = length(unique(user_screen_name))) %>%
  ungroup() %>%
  mutate(moving_n = zoo::rollmean(tweets, 
                                  k = 60, 
                                  fill = NA)) %>%
  ggplot() +
  geom_line(aes(x = created_at, 
                y = tweets)) +
  
    geom_line(aes(x = created_at,
                y = moving_n),
            color = 'steelblue',
            #linetype = 2,
            size = 0.75) +
  ggtitle('Daily tweets: US Congresses 115 & 116')
```


```{r eval=FALSE, include=FALSE}
## other potnetial diagnostics --
ttts <- xsum1 %>%
  group_by(congress, user_screen_name) %>%
  summarise(tweets = n(),
            tokens = sum(tokens))

t23 <- ttts %>% rename(twitter_handle = user_screen_name) %>%
  mutate(congress = as.integer(congress),
         twitter_handle = toupper(twitter_handle)) %>%
  left_join(cos) %>%
  select(bioname, congress:chamber, account_type:party_name) %>%
  select(-tokens) %>%
  spread(congress, tweets)

tts1 <- ttts %>%
  select(-tokens) %>%
  spread(congress, tweets)  
```


## References

Littman, Justin, 2017, "115th U.S. Congress Tweet Ids", https://doi.org/10.7910/DVN/UIVHQR, Harvard Dataverse, V5, UNF:6:pa6q3/72341rRixB7ez15Q== [fileUNF]

Wrubel, Laura; Kerchner, Daniel, 2020, "116th U.S. Congress Tweet Ids", https://doi.org/10.7910/DVN/MBOJNS, Harvard Dataverse, V1, UNF:6:WKfCGiEnn3FJi7QhnswUsA== [fileUNF]
